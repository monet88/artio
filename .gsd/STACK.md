# Technology Stack

> Auto-generated by /map on 2026-02-19 (updated 2026-02-21T00:57)

## Runtime

| Technology | Version | Purpose |
|------------|---------|---------|
| Flutter | SDK ^3.10.7 | Cross-platform UI framework |
| Dart | ^3.10.7 | Primary language |
| Deno | Supabase Edge Runtime | Edge Function runtime |
| TypeScript | N/A (Deno) | Edge Function language |

---

## Dependencies

### Production (Mobile App)

| Package | Version | Purpose |
|---------|---------|---------|
| flutter_riverpod | ^2.6.1 | State management |
| riverpod_annotation | ^2.6.1 | Riverpod code generation annotations |
| freezed_annotation | ^2.4.4 | Immutable data class annotations |
| json_annotation | ^4.9.0 | JSON serialization annotations |
| supabase_flutter | ^2.11.0 | Supabase client (Auth, DB, Storage, Edge Functions) |
| go_router | ^14.6.0 | Declarative routing |
| flex_color_scheme | ^8.2.0 | Theming with Material 3 |
| purchases_flutter | ^9.0.0 | RevenueCat in-app purchases (Pro/Ultra subscriptions) |
| google_mobile_ads | ^6.0.0 | AdMob rewarded ads (5 credits/ad) |
| sentry_flutter | ^8.12.0 | Error tracking |
| intl | ^0.20.1 | Internationalization/formatting |
| cached_network_image | ^3.4.1 | Image caching & loading |
| flutter_svg | ^2.0.17 | SVG rendering |
| image_picker | ^1.1.2 | Camera/gallery image selection |
| path_provider | ^2.1.5 | Platform file paths |
| shared_preferences | ^2.3.4 | Simple local key-value storage |
| connectivity_plus | ^6.1.1 | Network connectivity monitoring |
| flutter_dotenv | ^5.2.1 | Environment variable loading |
| logger | ^2.5.0 | Structured logging |
| equatable | ^2.0.7 | Value equality |
| share_plus | ^12.0.1 | Native share sheet |
| http | ^1.6.0 | HTTP client |
| flutter_staggered_grid_view | ^0.7.0 | Masonry/staggered grid layout |
| shimmer | ^3.0.0 | Shimmer loading effect |
| permission_handler | ^12.0.1 | Runtime permissions |
| image_gallery_saver_plus | ^4.0.1 | Save images to device gallery |
| package_info_plus | ^9.0.0 | App version info |
| flutter_animate | ^4.5.2 | Declarative animations |
| storage_client | any | Supabase storage client (transitive override) |

### Development (Mobile App)

| Package | Version | Purpose |
|---------|---------|---------|
| flutter_lints | ^6.0.0 | Lint rules |
| very_good_analysis | ^7.0.0 | Strict lint rules (primary) |
| build_runner | ^2.4.14 | Code generation runner |
| riverpod_generator | ^2.6.3 | Riverpod provider code generation |
| freezed | ^2.5.8 | Immutable data class code generation |
| json_serializable | ^6.9.2 | JSON serialization code generation |
| go_router_builder | ^2.7.2 | Type-safe route code generation |
| mockito | ^5.4.4 | Mock framework |
| mocktail | ^1.0.4 | Mock framework (primary, no codegen) |

### Production (Admin Dashboard)

| Package | Version | Purpose |
|---------|---------|---------|
| flutter_riverpod | ^2.6.1 | State management |
| riverpod_annotation | ^2.6.1 | Riverpod annotations |
| supabase_flutter | ^2.11.0 | Supabase client |
| flutter_dotenv | ^5.2.1 | Env loading |
| go_router | ^14.8.1 | Routing |
| cached_network_image | ^3.4.1 | Image caching |
| intl | ^0.20.1 | Formatting |
| gap | ^3.0.1 | Spacing widget |
| freezed_annotation | ^2.4.4 | Data class annotations |
| json_annotation | ^4.9.0 | JSON annotations |

### Development (Admin Dashboard)

| Package | Version | Purpose |
|---------|---------|---------|
| flutter_lints | ^6.0.0 | Lint rules |
| build_runner | ^2.4.14 | Code generation |
| riverpod_generator | ^2.6.3 | Riverpod codegen |
| freezed | ^2.5.8 | Freezed codegen |
| json_serializable | ^6.9.2 | JSON codegen |

---

## Infrastructure

| Service | Provider | Purpose | Status |
|---------|----------|---------|--------|
| Auth | Supabase Auth | Email/password authentication | âœ… Active |
| Database | Supabase (Postgres) | Templates, profiles, generation_jobs, user_credits, credit_transactions, ad_views | âœ… Active |
| Object Storage | Supabase Storage | Generated images (bucket: `generated-images`) | âœ… Active |
| Edge Functions | Supabase (Deno) | generate-image, reward-ad, revenuecat-webhook | âœ… Active |
| AI Generation (primary) | KIE.ai | Imagen4, Imagen4-Fast, Imagen4-Ultra, Nano-Banana, Flux-2, GPT Image, Seedream | âœ… Active |
| AI Generation (secondary) | Google Gemini | gemini-3-pro-image-preview, gemini-2.5-flash-image | âœ… Active |
| Error Tracking | Sentry | Production crash reporting | âœ… Active |
| In-App Purchases | RevenueCat | iOS/Android subscriptions (Pro: 200 credits/mo, Ultra: 500 credits/mo) | âœ… Implemented |
| Rewarded Ads | Google AdMob | Mobile rewarded interstitials (5 credits/ad, 10 ads/day max) | âœ… Implemented |
| Payments (Web) | Stripe | Web payments | ðŸ”œ Planned |

---

## Configuration

| Variable | Purpose | Location |
|----------|---------|----------|
| `SUPABASE_URL` | Supabase project URL | `.env.*` files |
| `SUPABASE_ANON_KEY` | Supabase anonymous API key | `.env.*` files |
| `SUPABASE_SERVICE_ROLE_KEY` | Service role key (Edge Functions only) | Supabase secrets |
| `GEMINI_API_KEY` | Google Gemini API key | Supabase secrets |
| `KIE_API_KEY` | KIE.ai API key | Supabase secrets |
| `SENTRY_DSN` | Sentry error tracking DSN | `.env.*` files |
| `REVENUECAT_APPLE_KEY` | RevenueCat Apple API key | `.env.*` files |
| `REVENUECAT_GOOGLE_KEY` | RevenueCat Google API key | `.env.*` files |
| `REVENUECAT_WEBHOOK_SECRET` | RevenueCat webhook auth secret | Supabase secrets |
| `CORS_ALLOWED_ORIGIN` | Allowed CORS origin for Edge Functions | Supabase secrets |
| `ENV` | Environment selector | Build-time `--dart-define=ENV=development` |

---

## Build & Code Generation

| Tool | Command | Purpose |
|------|---------|---------|
| build_runner | `dart run build_runner build --delete-conflicting-outputs` | Generate `.g.dart` / `.freezed.dart` files |
| flutter test | `flutter test` | Run unit + widget tests (76 test files) |
| integration tests | `flutter test integration_test/` | Run E2E tests (5 test files) |
| analysis | `flutter analyze` | Static analysis (very_good_analysis) â€” 0 issues âœ… |
| deno check | `deno task check` | Type-check all 5 Edge Function files â€” 0 issues âœ… |
| deno test | `deno task test` | Run Deno tests (15 tests across 2 test files) |

---

## Git Branches

| Branch | Purpose |
|--------|---------|
| `master` | Main branch (current HEAD) |
| `chore/milestone-transition` | Milestone transition bookkeeping |
| `feat/phase-3-credit-ui` | Credit system & premium gate UI |
| `feat/phase-4-admob-rewarded-ads` | AdMob rewarded ads integration |
| `feat/phase-5-revenuecat-subscriptions` | RevenueCat subscriptions |
| `feature/admin-dashboard-ui` | Admin dashboard UI |
| `feature/ui-ux-overhaul` | UI/UX redesign |
| `fix/ios-admob-config` | iOS AdMob configuration fix |

---

## Database Migrations

| Migration | Date | Purpose |
|-----------|------|---------|
| `20260127000000_create_templates_table` | 2026-01-27 | Templates table with RLS, indexes, updated_at trigger |
| `20260128000000_create_profiles_table` | 2026-01-28 | Profiles table with RLS, auto-create trigger on signup |
| `20260128094706_create_admin_user` | 2026-01-28 | Admin user/role setup |
| `20260128115551_add_deleted_at_and_storage_bucket` | 2026-01-28 | generation_jobs table, storage bucket, storage RLS |
| `20260128130000_add_25_templates` | 2026-01-28 | Seed 25 template records |
| `20260218000000_create_credit_system` | 2026-02-18 | user_credits, ad_views, credit_transactions tables; deduct/refund functions; welcome bonus |
| `20260218100000_create_reward_ad_function` | 2026-02-18 | reward_ad_credits atomic function (daily limit + credit award) |
| `20260219000000_add_subscription_support` | 2026-02-19 | Subscription columns on profiles; grant_subscription_credits + update_subscription_status functions |
| `20260219000001_restrict_profiles_update_rls` | 2026-02-19 | prevent_premium_self_update trigger to protect subscription columns |
